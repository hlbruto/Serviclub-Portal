(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"151f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[""!==e.$store.state.credencial.token?a("div",[a("div",{staticClass:"q-pa-lg text-blue-grey-1 text-caption"},[a("q-item-label",[e._v("INFORMACIÓN PERSONAL Y DATOS DE ACCESO")]),a("q-separator",{staticClass:"bg-blue-grey-1",attrs:{inset:""}})],1),a("div",{staticClass:"q-pa-md row justify-evenly"},[e.$q.screen.gt.xs?a("div",{staticClass:"col-5"},[a("DatosPersonales")],1):a("div",{staticClass:"col-10"},[a("DatosPersonales"),a("CambiarCorreo"),a("CambiarPass")],1),e.$q.screen.gt.xs?a("div",{staticClass:"col-5"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("CambiarCorreo")],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("CambiarPass")],1)])]):e._e()])]):a("div",[a("NoAcceso")],1)])},o=[],s={name:"Perfil",components:{DatosPersonales:a("1f39").default,CambiarCorreo:a("796b").default,CambiarPass:a("f9d3").default,NoAcceso:a("ef12").default}},r=s,n=a("2877"),c=Object(n["a"])(r,i,o,!1,null,null,null);t["default"]=c.exports},"1f39":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-mb-lg"},[a("q-card",[a("form",{on:{submit:e.onSubmit}},[a("q-card-section",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-pt-none"},[a("q-input",{ref:"nombre",attrs:{filled:"","label-slot":"",clearable:"","lazy-rules":"",rules:[function(e){return!!e||"El campo es obligatorio"}]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"col-auto"},[e._v("Nombre y apellidos")])]},proxy:!0}]),model:{value:e.datos.nombre,callback:function(t){e.$set(e.datos,"nombre",t)},expression:"datos.nombre"}}),a("q-input",{ref:"ci",attrs:{filled:"",type:"number","label-slot":"",clearable:"",counter:"","lazy-rules":"",rules:[function(e){return!!e||"El campo es obligatorio"},function(e){return e.length>=11||"Debe tener 11 dígitos"}]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"col-auto"},[e._v("No. Identidad")])]},proxy:!0}]),model:{value:e.datos.ci,callback:function(t){e.$set(e.datos,"ci",t)},expression:"datos.ci"}}),a("q-input",{ref:"telefono",attrs:{filled:"",type:"number","label-slot":"",clearable:"","lazy-rules":"",counter:"",rules:[function(e){return!!e||"El campo es obligatorio"},function(e){return e.length>=8||"Debe ser mayor de 7 dígitos"}]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"col-auto"},[e._v("Teléfono")])]},proxy:!0}]),model:{value:e.datos.telefono,callback:function(t){e.$set(e.datos,"telefono",t)},expression:"datos.telefono"}}),a("q-input",{ref:"direccion",attrs:{filled:"",type:"text","label-slot":"",clearable:"","lazy-rules":"",rules:[function(e){return!!e||"El campo es obligatorio"}]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"col-auto"},[e._v("Dirección particular")])]},proxy:!0}]),model:{value:e.datos.direccion,callback:function(t){e.$set(e.datos,"direccion",t)},expression:"datos.direccion"}}),a("SelectsProvMun")],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{staticClass:"bg-primary text-white",attrs:{size:"md",push:"",label:"Guardar"},on:{click:function(t){return e.onSubmit()}}})],1)],1)])],1)},o=[],s=a("ded3"),r=a.n(s),n=a("2f62"),c={name:"DatosPersonales",components:{SelectsProvMun:a("646a").default},computed:r()({},Object(n["b"])(["provincias","arrayNombresProv","municipios"])),data:function(){return{datos:{nombre:"",ci:"",telefono:"",direccion:"",municipioId:""}}},created:function(){this.llenarPerfil()},mounted:function(){},methods:{onSubmit:function(){this.$refs.nombre.validate(),this.$refs.ci.validate(),this.$refs.telefono.validate(),this.$refs.direccion.validate(),(this.$refs.nombre.hasError||this.$refs.ci.hasError||this.$refs.telefono.hasError||this.$refs.direccion.hasError)&&(this.formHasError=!0),""==this.$store.state.credencial.municipio.id?this.$q.notify({color:"negative",position:"bottom",message:"Debe llenar los campos provincia y municipio",icon:"mdi-alert-circle"}):(console.log("va a actualizar el perfil"),this.guardar())},mensajeSatisfactorio:function(){this.$q.notify({color:"positive",position:"bottom",message:"Su datos han sido actualizados",icon:"mdi-check-circle"})},llenarPerfil:function(){console.log(this.$store.state.credencial.nombre),this.datos.nombre=this.$store.state.credencial.nombre,this.datos.ci=this.$store.state.credencial.ci,this.datos.telefono=this.$store.state.credencial.telefono,this.datos.direccion=this.$store.state.credencial.direccion},guardar:function(){var e=this;this.datos.municipioId=this.$store.state.credencial.municipio.id,console.log(this.datos),console.log("entra al 1"),localStorage.clear(),this.$axios.patch(this.$store.state.urlAPI+"/perfil/"+this.$store.state.credencial.id_usuario,this.datos).then((function(t){e.$store.state.credencial.id_usuario=t.data.credencial.id_usuario,e.$store.state.credencial.activo=t.data.credencial.activo,e.$store.state.credencial.estado=t.data.credencial.estado,e.$store.state.credencial.email=t.data.credencial.email,e.$store.state.credencial.token=t.data.credencial.token,e.$store.state.credencial.municipio=t.data.credencial.municipio,e.$store.state.credencial.municipio.nombre=t.data.credencial.municipio.nombre,e.$store.state.credencial.municipio.provincia.nombre=t.data.credencial.municipio.provincia.nombre,t.data.credencial.instalacionId&&(e.$store.state.credencial.instalacion=t.data.credencial.instalacion,e.$store.state.instalacionPreferida=t.data.credencial.instalacion.nombre,e.$store.state.instalacionDelPedido=t.data.credencial.instalacion),e.$store.state.credencial.nombre=t.data.credencial.nombre,e.$store.state.credencial.telefono=t.data.credencial.telefono,e.$store.state.credencial.direccion=t.data.credencial.direccion,e.$store.state.credencial.ci=t.data.credencial.ci;var a=JSON.stringify({credencial:t.data.credencial});localStorage.setItem("key",a),console.log(a),e.llenarPerfil(),e.mensajeSatisfactorio()})).catch((function(e){console.log("entra al 3"),console.log(e)}))}}},l=c,d=a("2877"),u=Object(d["a"])(l,i,o,!1,null,null,null);t["default"]=u.exports},"796b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-card",[a("q-card-section",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-pt-none"},[a("q-input",{attrs:{filled:"",type:"email","label-slot":"",clearable:"","lazy-rules":"",rules:[function(e){return!!e||"El campo es obligatorio"},function(e){return/.+@.+\..+/.test(e)||"El correo debe ser válido"}]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"row items-center all-pointer-events"},[e._v("\n                Email\n\n                "),a("q-tooltip",{attrs:{"content-class":"bg-grey-8",anchor:"top left",self:"bottom left",offset:[0,8]}},[e._v("\n                  Dirección de correo\n                ")])],1)]},proxy:!0}]),model:{value:e.$store.state.credencial.email,callback:function(t){e.$set(e.$store.state.credencial,"email",t)},expression:"$store.state.credencial.email"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{staticClass:"bg-primary text-white",attrs:{push:"",label:"Cambiar y verificar",size:"md"},on:{click:function(t){return e.validarDatos()}}})],1)],1),a("ValidarEmail")],1)},o=[],s={name:"CambiarCorreo",components:{ValidarEmail:a("41f4").default},data:function(){return{datos:{email:"",credencial:""}}},created:function(){this.datos.email=this.$store.state.credencial.email},methods:{validarDatos:function(){""!==this.datos.email&&null!==this.datos.email?this.datos.email!==this.$store.state.credencial.email?this.cambiar():this.mensajeDatosIncorrectos():this.mensajeDatosIncompletos()},mensajeDatosIncorrectos:function(){this.$q.notify({color:"negative",position:"bottom",message:"Usted no ha modificado su correo electrónico",icon:"mdi-alert-circle"})},mensajeDatosIncompletos:function(){this.$q.notify({color:"negative",position:"bottom",message:"Debe escribir un nuevo correo electrónico",icon:"mdi-alert-circle"})},mensajeSatisfactorio:function(){this.$q.notify({color:"positive",position:"bottom",message:"El correo electrónico se modificó correctamente",icon:"mdi-check-circle"})},cambiar:function(){var e=this;this.datos.email=this.$store.state.credencial.email,this.datos.credencial=this.$store.state.credencial,this.$axios.post(this.$store.state.urlAPI+"/cambiar-email",this.datos).then((function(t){console.log(t.data),"existe1"==t.data||"existe"==t.data?(console.log("mensaje de usuario ya existe en el sistema"),e.$q.notify({color:"negative",position:"bottom",message:"Debe escribir un nuevo correo electrónico ese ya se encuentra registrado en el sistema",icon:"mdi-alert-circle"})):0==t.data?(console.log("mensaje de error al enviar correo"),e.$store.state.emailAutenticar=e.$store.state.credencial.email,e.$store.state.dialogo.validarEmail=!0):1==t.data&&(console.log("mensaje de correo enviado, mandar a verificar codigo"),e.$store.state.dialogo.validarEmail=!0),e.mensajeSatisfactorio()})).catch((function(e){console.log(e)})),this.mensajeSatisfactorio()}}},r=s,n=a("2877"),c=Object(n["a"])(r,i,o,!1,null,null,null);t["default"]=c.exports},f9d3:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-card",[a("q-card-section",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-pt-none"},[a("q-input",{attrs:{filled:"",type:e.isPwd?"password":"text","label-slot":"",clearable:"",counter:"","lazy-rules":"",rules:[function(e){return!!e||"El campo es obligatorio"},function(e){return e.length>=8||"Debe ser mayor de 7 caracteres"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("div",{staticClass:"row items-center all-pointer-events"},[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})],1)]},proxy:!0}]),model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{staticClass:"bg-primary text-white",attrs:{push:"",label:"Cambiar",size:"md"},on:{click:function(t){return e.validarDatos()}}})],1)],1)],1)},o=[],s={name:"CambiarPass",data:function(){return{password:"",isPwd:!0}},methods:{validarDatos:function(){""!==this.password?this.cambiar():this.mensajeDatosIncompletos()},mensajeDatosIncompletos:function(){this.$q.notify({color:"negative",position:"bottom",message:"Debe escribir una nueva contraseña de más de 7 caracteres",icon:"mdi-alert-circle"})},mensajeSatisfactorio:function(){this.$q.notify({color:"positive",position:"bottom",message:"La contraseña se modificó correctamente",icon:"mdi-check-circle"})},cambiar:function(){var e={password:this.password};this.$axios.patch(this.$store.state.urlAPI+"/usuarios/"+this.$store.state.credencial.id_usuario,e).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)})),this.mensajeSatisfactorio()}}},r=s,n=a("2877"),c=Object(n["a"])(r,i,o,!1,null,null,null);t["default"]=c.exports}}]);